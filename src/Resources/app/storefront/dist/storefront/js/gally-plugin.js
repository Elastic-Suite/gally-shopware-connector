"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["gally-plugin"],{4835:(e,t,i)=>{var s=i(3629),l=i(8254),r=i(3206);class n extends s.Z{init(){super.init(),this.client=new l.Z,this.filterPanel=document.getElementById("filter-panel-wrapper").querySelector(".filter-panel");let e=this.el.querySelector(".viewMoreLink");e&&e.addEventListener("click",this.viewMore.bind(this))}setValuesFromUrl(e={}){let t=!1;const i=e[this.options.name],s=i?i.split("|"):[],l=this.selection.filter((e=>!s.includes(e))),n=s.filter((e=>!this.selection.includes(e)));return(l.length>0||n.length>0)&&(t=!0),n.forEach((e=>{const t=r.Z.querySelector(this.el,`[id="${e}"]`,!1);t&&(t.checked=!0),this.selection.push(e)})),l.forEach((e=>{this.reset(e),this.selection=this.selection.filter((t=>t!==e))})),this._updateCount(),t}viewMore(e){e.preventDefault(),this.listing.addLoadingIndicatorClass();let t=JSON.parse(this.el.dataset.filterPropertySelectOptions);this.client.post("/gally/viewMore",JSON.stringify({aggregation:t.name}),this.updateFilterElement.bind(this),"application/json",!0)}updateFilterElement(e){let t=document.createElement("ul");t.classList.add("filter-multi-select-list"),JSON.parse(e).forEach(function(e){let i=document.createElement("div"),s=document.createElement("li"),l=this.getInput(e.value,e.label);this.selection.includes(e.value)&&l.setAttribute("checked","checked"),i.classList.add("form-check"),i.appendChild(l),i.appendChild(this.getLabel(e.value,e.label,e.count)),s.classList.add("filter-multi-select-list-item"),s.classList.add("filter-property-select-list-item"),s.appendChild(i),t.appendChild(s)}.bind(this)),this.el.querySelector("ul.filter-multi-select-list").replaceWith(t),this._registerEvents(),this.el.querySelector(".viewMoreLink").style.display="none",this.listing.removeLoadingIndicatorClass(),this.filterPanel.classList.remove("is-loading")}getInput(e,t){let i=document.createElement("input");return i.classList.add("form-check-input"),i.classList.add("filter-multi-select-checkbox"),i.setAttribute("type","checkbox"),i.setAttribute("id",e),i.setAttribute("value",e),i.setAttribute("data-label",t),i}getLabel(e,t,i){let s=document.createElement("label");return s.classList.add("filter-multi-select-item-label"),s.classList.add("form-check-label"),s.setAttribute("for",e),s.textContent=t+" ("+i+")",s}}window.PluginManager.override("FilterPropertySelect",n,"[data-filter-property-select]")},6536:(e,t,i)=>{i.d(t,{Z:()=>a});var s,l,r,n=i(6285),o=i(3206);class a extends n.Z{_init(){super._init(),this._validateMethods();const e=o.Z.querySelector(document,this.options.parentFilterPanelSelector);this.listing=window.PluginManager.getPluginInstanceFromElement(e,"Listing"),this.listing.registerFilter(this),this._preventDropdownClose()}_preventDropdownClose(){const e=o.Z.querySelector(this.el,this.options.dropdownSelector,!1);e&&e.addEventListener("click",(e=>{e.stopPropagation()}))}_validateMethods(){if("function"!=typeof this.getValues)throw new Error(`[${this._pluginName}] Needs the method "getValues"'`);if("function"!=typeof this.getLabels)throw new Error(`[${this._pluginName}] Needs the method "getLabels"'`);if("function"!=typeof this.reset)throw new Error(`[${this._pluginName}] Needs the method "reset"'`);if("function"!=typeof this.resetAll)throw new Error(`[${this._pluginName}] Needs the method "resetAll"'`)}}s=a,r={parentFilterPanelSelector:".cms-element-product-listing-wrapper",dropdownSelector:".filter-panel-item-dropdown"},(l=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(l="options"))in s?Object.defineProperty(s,l,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[l]=r},5410:(e,t,i)=>{i.d(t,{Z:()=>d});var s,l,r,n=i(3206),o=i(1966),a=i(6536),c=i(1857),h=i.n(c);class d extends a.Z{init(){this.selection=[],this.counter=n.Z.querySelector(this.el,this.options.countSelector),this._registerEvents()}_registerEvents(){const e=n.Z.querySelectorAll(this.el,this.options.checkboxSelector);o.Z.iterate(e,(e=>{e.addEventListener("change",this._onChangeFilter.bind(this))}))}getValues(){const e=n.Z.querySelectorAll(this.el,`${this.options.checkboxSelector}:checked`,!1);let t=[];e?o.Z.iterate(e,(e=>{t.push(e.id)})):t=[],this.selection=t,this._updateCount();const i={};return i[this.options.name]=t,i}getLabels(){const e=n.Z.querySelectorAll(this.el,`${this.options.checkboxSelector}:checked`,!1);let t=[];return e?o.Z.iterate(e,(e=>{t.push({label:e.dataset.label,id:e.id})})):t=[],t}setValuesFromUrl(e={}){let t=!1;const i=e[this.options.name],s=i?i.split("|"):[],l=this.selection.filter((e=>!s.includes(e))),r=s.filter((e=>!this.selection.includes(e)));return(l.length>0||r.length>0)&&(t=!0),r.forEach((e=>{const t=n.Z.querySelector(this.el,`[id="${e}"]`,!1);t&&(t.checked=!0,this.selection.push(t.id))})),l.forEach((e=>{this.reset(e),this.selection=this.selection.filter((t=>t!==e))})),this._updateCount(),t}_onChangeFilter(){this.listing.changeListing(!0,{p:1})}reset(e){const t=n.Z.querySelector(this.el,`[id="${e}"]`,!1);t&&(t.checked=!1)}resetAll(){this.selection.filter=[];const e=n.Z.querySelectorAll(this.el,`${this.options.checkboxSelector}:checked`,!1);e&&o.Z.iterate(e,(e=>{e.checked=!1}))}refreshDisabledState(e){const t=e[this.options.name];!t.entities||t.entities.length<1?this.disableFilter():(this.enableFilter(),this._disableInactiveFilterOptions(t.entities.map((e=>e.id))))}_disableInactiveFilterOptions(e){const t=n.Z.querySelectorAll(this.el,this.options.checkboxSelector);o.Z.iterate(t,(t=>{!0!==t.checked&&(e.includes(t.id)?this.enableOption(t):this.disableOption(t))}))}disableOption(e){const t=e.closest(this.options.listItemSelector);t.classList.add("disabled"),t.setAttribute("title",this.options.snippets.disabledFilterText),e.disabled=!0}enableOption(e){const t=e.closest(this.options.listItemSelector);t.removeAttribute("title"),t.classList.remove("disabled"),e.disabled=!1}enableAllOptions(){const e=n.Z.querySelectorAll(this.el,this.options.checkboxSelector);o.Z.iterate(e,(e=>{this.enableOption(e)}))}disableFilter(){const e=n.Z.querySelector(this.el,this.options.mainFilterButtonSelector);e.classList.add("disabled"),e.setAttribute("disabled","disabled"),e.setAttribute("title",this.options.snippets.disabledFilterText)}enableFilter(){const e=n.Z.querySelector(this.el,this.options.mainFilterButtonSelector);e.classList.remove("disabled"),e.removeAttribute("disabled"),e.removeAttribute("title")}_updateCount(){this.counter.innerText=this.selection.length?`(${this.selection.length})`:""}}s=d,l="options",r=h()(a.Z.options,{checkboxSelector:".filter-multi-select-checkbox",countSelector:".filter-multi-select-count",listItemSelector:".filter-multi-select-list-item",snippets:{disabledFilterText:"Filter not active"},mainFilterButtonSelector:".filter-panel-item-toggle"}),(l=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(l))in s?Object.defineProperty(s,l,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[l]=r},3629:(e,t,i)=>{i.d(t,{Z:()=>d});var s,l,r,n=i(5410),o=i(1966),a=i(3206),c=i(1857),h=i.n(c);class d extends n.Z{getLabels(){const e=a.Z.querySelectorAll(this.el,`${this.options.checkboxSelector}:checked`,!1);let t=[];return e?o.Z.iterate(e,(e=>{t.push({label:e.dataset.label,id:e.id,previewHex:e.dataset.previewHex,previewImageUrl:e.dataset.previewImageUrl})})):t=[],t}refreshDisabledState(e){if(""===this.options.propertyName)return;const t=[],i=e[this.options.name].entities;if(!i)return void this.disableFilter();const s=i.find((e=>e.translated.name===this.options.propertyName));if(!s)return void this.disableFilter();t.push(...s.options);const l=this.getValues();t.length<1&&0===l.properties.length?this.disableFilter():(this.enableFilter(),l.properties.length>0||this._disableInactiveFilterOptions(t.map((e=>e.id))))}}s=d,l="options",r=h()(n.Z.options,{propertyName:""}),(l=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(l))in s?Object.defineProperty(s,l,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[l]=r}},e=>{e.O(0,["vendor-node","vendor-shared"],(()=>{return t=4835,e(e.s=t);var t}));e.O()}]);